
<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">
<html>
<head>
<meta name="template" content="Vijeo_template.htt">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="date" content="08 14, 2003 11:41:17 AM">
 <meta name="generator" content="Adobe RoboHelp 10">
<title>Utilisation de variables dans les scripts</title>
<link rel="StyleSheet" href="TIS-STYL.CSS" type="text/css">
</head>
<body>
<script type="text/javascript" src="ehlpdhtm.js" language="JavaScript1.2"></script>




<div style="width: 100%; position: relative;" id="header">
	<table style="background-attachment: scroll; margin-left: 0px; margin-right: 4px; 
			 background-image: url(top_banner.bmp); background-repeat: Repeat-X; 
			 line-height: 0pt; vertical-align: top;" cellspacing="0" width="100%" 
			 background="top_banner.bmp">
		<col style="width: 90%;">
		<col style="width: 5%;">
		<col style="width: 5%;">
		<tr style="vertical-align: center; height: 39px;">
			<td style="width: 90%; padding-right: 10px; padding-left: 10px; 
				 border-right-color: #000000;">
   <p><img src="logo.bmp" style="border: none;" alt="" width="37" height="37" border="0"></p></td>
			<td style="width: 5%; padding-right: 0px; padding-left: 10px; 
				 border-right-color: #000000;">
   <p style="text-align: center;"><a 
			 title="Glossary" href="Appendix.chm::/Glossary.htm"><img src="logo_glossary.bmp" style="border: none;" alt="" width="47" height="37" border="0"></a></p></td>
			<td style="width: 5%; padding-right: 10px; padding-left: 5px; 
				 border-right-color: #000000;">
   <p style="text-align: center;"><a 
			 href="About.chm::/What_is_Vijeo-Designer.htm" title="Home"><img src="logo_home.bmp" alt="Home" title="Home" style="border: none; 
			 margin-left: 0px; margin-right: 0px; margin-bottom: 0px; margin-top: -2px;" width="47" height="37" border="0"></a></p></td>
		</tr>
	</table>
</div>

<h3>18.3.2.2 Utilisation de variables dans des scripts</h3>
<p>Pour utiliser une variable Vijeo Designer dans un script, commencez par obtenir sa valeur et affectez-la à une variable de script. Vous pouvez ensuite utiliser cette variable de script dans n'importe quelle expression.</p>
<p class="Image"><img src="Vijeo_Var_ScriptVar_Methods.bmp" style="border: none;" alt="" width="453" height="139" border="0"></p>
<ol style="list-style: decimal;">
<li class="p">
<p>Déclarez une variable de script.<br>
Assurez-vous que le type de données de la variable est pris en charge dans Vijeo Designer.</p>
</li>
</ol>

<p class="Code" style="margin-left: 80px;"><span style="color: #0000ff;">int</span> x = 0;</p>

<p class="Image" style="margin-left: 80px; margin-top: 9pt;"><img src="0ScriptVar.bmp" style="border: none;" alt="" width="37" height="52" border="0"></p>
<table style="vertical-align: top; margin-left: 40px; margin-bottom: 10px;" cellspacing="0" width="83.556%">
<col style="width: 32.314%;">
<col style="width: 67.686%;">
<tr style="vertical-align: top;">
<td style="border-top: Solid 3px #000000; border-right: Solid 1px #000000; border-bottom: Solid 1px #000000; width: 32.314%; padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px;" bgcolor="#91AFD9">
<p class="Tabletitle">Variable Vijeo Designer</p>
</td>
<td style="border-top: Solid 3px #000000; border-bottom: Solid 1px #000000; width: 67.686%; padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px;" bgcolor="#91AFD9">
<p class="Tabletitle">Types de données de script pris en charge</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td style="border-right: Solid 1px #000000; border-bottom: Solid 1px #000000; width: 32.314%; padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px;" bgcolor="#CBD9ED">
<p class="TableDefinitions">BOOL</p>
</td>
<td style="border-bottom: Solid 1px #000000; width: 67.686%; padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px;">
<p class="Tabletext">En règle générale, utilisez <span style="font-family: 'Courier New', monospace;">boolean</span>.</p>
<p class="Tabletext">Vous pouvez également utiliser <span style="font-family: 'Courier New', monospace;">int</span>, <span style="font-family: 'Courier New', monospace;">long</span>, <span style="font-family: 'Courier New', monospace;">float</span>, ou <span style="font-family: 'Courier New', monospace;">double</span>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td style="border-right: Solid 1px #000000; border-bottom: Solid 1px #000000; width: 32.314%; padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px;" bgcolor="#CBD9ED">
<p class="TableDefinitions">INT, UINT, DINT, UDINT, Entier</p>
</td>
<td style="border-bottom: Solid 1px #000000; width: 67.686%; padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px;">
<p class="Tabletext">En règle générale, utilisez <span style="font-family: 'Courier New', monospace;">int</span>.</p>
<p class="Tabletext">Vous pouvez également utiliser <span style="font-family: 'Courier New', monospace;">long</span>, <span style="font-family: 'Courier New', monospace;">float</span> ou <span style="font-family: 'Courier New', monospace;">double</span>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td style="border-right: Solid 1px #000000; border-bottom: Solid 1px #000000; width: 32.314%; padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px;" bgcolor="#CBD9ED">
<p class="TableDefinitions">REAL</p>
</td>
<td style="border-bottom: Solid 1px #000000; width: 67.686%; padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px;">
<p class="Tabletext">En règle générale, utilisez <span style="font-family: 'Courier New', monospace;">float</span>.</p>
<p class="Tabletext">Vous pouvez également utiliser <span style="font-family: 'Courier New', monospace;">double</span>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td style="border-right: Solid 1px #000000; border-bottom: Solid 3px #000000; width: 32.314%; padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px;" bgcolor="#CBD9ED">
<p class="TableDefinitions">STRING</p>
</td>
<td style="border-bottom: Solid 3px #000000; width: 67.686%; padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px;">
<p class="Tabletext">Utilisez la classe String.</p>
<p class="Tabletext">&#160;</p>
<p class="Tabletext">P. ex. : String a = "Vijeo Designer String";</p>
</td>
</tr>
</table>
<p style="margin-left: 40px;">Pour plus d'informations sur comment configurer des variables de script, reportez-vous à la section 18.3.2.1, <a href="script_variable_and_variable.htm#1">Déclaration de variables de script</a>.</p>
<ol start="2" style="list-style: decimal;">
<li class="p">
<p>Obtenez la valeur de la variable Vijeo Designer et affectez-la à la variable de script.<br>
A la fin de la méthode d'obtention de la valeur, veillez à ajouter des parenthèses <span style="font-weight: bold;">( )</span> puis un point virgule <span style="font-weight: bold;">;</span>.</p>
</li>
</ol>
<p class="Code" style="margin-left: 80px;">x = LigneA_Sortie.getIntValue();</p>
<p class="Image" style="margin-left: 80px; margin-top: 9pt;"><img src="Vijeo_100ScriptVar.bmp" style="border: none;" alt="" width="255" height="95" border="0"></p>
<p style="margin-left: 40px;">La méthode getValue que vous utilisez dépend du type de données avec lequel vous voulez travailler. Le tableau suivant dresse la liste des méthodes que vous êtes susceptible d'utiliser avec chaque type de données de variable Vijeo Designer.</p>
<table style="vertical-align: top; margin-left: 40px;" cellspacing="0" width="300">
<col style="width: 60%;">
<col style="width: 40%;">
<tr style="vertical-align: top;">
<td style="border-top: Solid 3px #000000; border-right: Solid 1px #000000; border-bottom: Solid 1px #000000; width: 60%; padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px;" bgcolor="#91AFD9">
<p class="Tabletitle">Variable Vijeo Designer</p>
</td>
<td style="border-top: Solid 3px #000000; border-bottom: Solid 1px #000000; width: 40%; padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px;" bgcolor="#91AFD9">
<p class="Tabletitle">Méthode</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td style="border-right: Solid 1px #000000; border-bottom: Solid 1px #000000; width: 60%; padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px;">
<p class="Tabletext">BOOL</p>
<p class="Tabletext">Type Entier</p>
</td>
<td style="border-bottom: Solid 1px #000000; width: 40%; padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px;">
<p class="Tabletext">getIntValue( )</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td style="border-right: Solid 1px #000000; border-bottom: Solid 1px #000000; width: 60%; padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px;">
<p class="Tabletext">REAL</p>
</td>
<td style="border-bottom: Solid 1px #000000; width: 40%; padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px;">
<p class="Tabletext">getFloatValue( )</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td style="border-right: Solid 1px #000000; border-bottom: Solid 3px #000000; width: 60%; padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px;">
<p class="Tabletext">STRING</p>
</td>
<td style="border-bottom: Solid 3px #000000; width: 40%; padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px;">
<p class="Tabletext">getStringValue( )</p>
</td>
</tr>
</table>
<ol start="3" style="list-style: decimal;">
<li class="p">
<p>Utilisez la variable de script locale.</p>
</li>
</ol>

<p class="Code" style="margin-left: 80px;">if (x &#160;&lt;= 10 )</p>

<p class="NoteImage" style="margin-left: 0px; margin-top: 6pt;"><img src="Note_Moji.bmp" style="border: none;" alt="" width="51" height="25" border="0"></p>
<ul>
<li class="p-NoteText">
<p class="NoteText">Pour obtenir la valeur d'une variable du type BOOL, utilisez la méthode <span style="font-weight: bold;">getIntValue()</span>.</p>
</li>
<li class="p-NoteText">
<p class="NoteText">Chaque variable Vijeo-Designer prend en charge des méthodes pour retourner sa valeur sous forme d'entier, de réel ou de chaîne.</p>
</li>
</ul>
<p class="NoteText" style="margin-left: 40px;">Exemple :<br>
La valeur de la variable entière LigneA_Sortie de Vijeo Designer est de 561.</p>
<p class="NoteText" style="font-family: 'Courier New', monospace; margin-left: 80px;">LigneA_Sortie.getIntValue( ) retourne <span style="font-weight: bold;">561</span></p>
<p class="NoteText" style="font-family: 'Courier New', monospace; margin-left: 80px;">LigneA_Sortie.getFloatValue( ) retourne <span style="font-weight: bold;">561.0f</span></p>
<p class="NoteText" style="font-family: 'Courier New', monospace; margin-left: 80px;">LigneA_Sortie.getStringValue( ) retourne <span style="font-weight: bold;">"561"</span></p>
<ul>
<li class="p-NoteText">
<p class="NoteText">Lorsque vous utilisez la méthode d'obtention d'une valeur pour des variables Vijeo Designer, vous pouvez vous servir du menu contextuel pour sélectionner la variable et la méthode de variable.</p>
</li>
</ul>
<p class="Image"><img src="Vijeo_Insert_menu.bmp" style="border: none;" alt="" width="750" height="368" border="0"><br>
&#160;</p>
</body>
</html>
